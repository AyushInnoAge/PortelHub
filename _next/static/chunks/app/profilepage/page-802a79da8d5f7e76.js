(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[395],{5602:(e,a,l)=>{Promise.resolve().then(l.bind(l,1760))},6625:(e,a,l)=>{"use strict";l.d(a,{c:()=>n,e:()=>t});var s=l(2818);let i=()=>localStorage.getItem("token"),t=async(e,a,l,t,n)=>{try{let o=i(),r=new FormData;r.append("patchDoc",JSON.stringify([{op:"replace",path:"/Email",value:a},{op:"replace",path:"/PhoneNo",value:l},{op:"replace",path:"/Address",value:t}])),n&&r.append("imageFile",n);let d="".concat(s.env.NEXT_PUBLIC_API_URL,"User/UpdateUserProfile/").concat(e),c=await fetch(d,{method:"PATCH",headers:{Authorization:"Bearer ".concat(o)},body:r});return await c.json()}catch(e){throw Error(e.message)}},n=async(e,a)=>{try{let l=i(),t=new FormData;t.append("patchDoc",JSON.stringify([{op:"replace",path:"/isActive",value:!1}])),a&&t.append("imageFile",a);let n="".concat(s.env.NEXT_PUBLIC_API_URL,"User/UpdateUserProfile/").concat(e),o=await fetch(n,{method:"PATCH",headers:{Authorization:"Bearer ".concat(l)},body:t});return await o.json()}catch(e){throw Error(e.message)}}},1760:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>h});var s=l(5155),i=l(2115),t=l(1536),n=l(8100);l(346);var o=l(2792),r=l(2110);l(5716);var d=l(3201),c=l(6625);function h(){var e;let{user:a,login:l}=(0,i.useContext)(d.c),[h,m]=(0,i.useState)([]),[u,p]=(0,i.useState)(!1),[v,x]=(0,i.useState)(null==a?void 0:a.image),[j,g]=(0,i.useState)(null==a?void 0:a.email),[N,f]=(0,i.useState)(null==a?void 0:a.phoneNo),[b,w]=(0,i.useState)(null==a?void 0:a.address),y=null==a?void 0:a.achievements.split(",").filter(e=>e.trim().startsWith("Star of the month")).length,S=null==a?void 0:a.achievements.split(",").filter(e=>e.trim().startsWith("Shoutout")).length,C=(null==a?void 0:null===(e=a.achievements)||void 0===e?void 0:e.split(",").filter(e=>e.trim().startsWith("Star of the month")).map(e=>{let a=e.split(" - ")[2],l=new Date(null==a?void 0:a.trim());return isNaN(l.getTime())?null:l.toLocaleString("default",{month:"long",year:"numeric"})}).filter(e=>null!==e))||[],E=(null==C?void 0:C.length)||0,P=[...new Set(C)].join(", ");(0,i.useEffect)(()=>{let e=[];y>0&&e.push({name:"".concat(y," Star").concat(y>1?"s":""," of the Month"),color:"badge-red"}),S>0&&e.push({name:"".concat(S," Shoutout").concat(S>1?"s":""),color:"badge-yellow"}),m(e)},[y,S]);let I=async()=>{if(u)try{let s=await (0,c.e)(a.employeeId,j,N,b,v);if(200==s.statusCode){var e;let i=null===(e=s.result)||void 0===e?void 0:e.imageUrl;r.oR.success("User Profile updated successfully!");let t={address:b,department:a.department,designation:a.designation,dob:a.dob,doj:a.doj,email:j,employeeId:a.employeeId,id:a.id,image:v,name:a.name,phoneNo:N,teamLeaderEmail:a.teamLeaderEmail,teamLeaderId:a.teamLeaderId,teamLeaderName:a.teamLeaderName,userRole:a.userRole,achievements:a.achievements};i&&(t.image=i),localStorage.removeItem("user"),l(t)}}catch(e){console.error(e),r.oR.error("User Updation Failed!")}p(!u)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.default,{}),(0,s.jsx)(r.N9,{position:"top-right",autoClose:3e3}),(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("div",{className:"profile-card",children:[(0,s.jsxs)("div",{className:"xps-icon",children:[(0,s.jsx)(n.bqp,{className:"icon1"}),(0,s.jsx)("a",{href:"/available-xps",className:"xps-text",children:"Available XPs"})]}),(0,s.jsxs)("div",{className:"profile-left",children:[(0,s.jsxs)("div",{className:"profile-img-wrapper",children:[(0,s.jsx)("img",{src:(null==a?void 0:a.image.length)>0?a.image:"https://api.dicebear.com/7.x/initials/svg?seed=".concat(null==a?void 0:a.name),alt:"Profile",width:160,height:160,className:"profile-img"}),u&&(0,s.jsxs)("label",{className:"image-edit-label",children:[(0,s.jsx)(n.opn,{className:"image-edit-icon"}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>x(e.target.files[0]),hidden:!0})]})]}),(0,s.jsx)("h2",{className:"profile-name",children:null==a?void 0:a.name}),(0,s.jsx)("p",{className:"profile-designation",children:null==a?void 0:a.designation}),(0,s.jsx)("p",{className:"profile-designation",children:null==a?void 0:a.department}),(0,s.jsxs)("div",{className:"badges",children:[(0,s.jsx)("h3",{className:"badge-title",children:"Badges Earned"}),(0,s.jsx)("div",{className:"badge-list",children:h.map((e,a)=>(0,s.jsx)("span",{className:"badge ".concat(e.color),children:e.name},a))})]})]}),(0,s.jsxs)("div",{className:"profile-right",children:[(0,s.jsxs)("div",{className:"profile-info",children:[(0,s.jsx)("h3",{className:"section-title",children:"Personal Information"}),(0,s.jsxs)("div",{className:"info-row",children:[(0,s.jsx)("label",{children:"Full Name"}),(0,s.jsx)("p",{children:null==a?void 0:a.name})]}),(0,s.jsxs)("div",{className:"info-row",children:[(0,s.jsx)("label",{children:"Employee ID"}),(0,s.jsx)("p",{children:null==a?void 0:a.employeeId})]}),(0,s.jsxs)("div",{className:"info-row",children:[(0,s.jsx)("label",{children:"Team"}),(0,s.jsx)("p",{children:null==a?void 0:a.department})]}),(0,s.jsxs)("div",{className:"info-row",children:[(0,s.jsx)("label",{children:"Email"}),u?(0,s.jsx)("input",{type:"text",name:"Email",value:j,onChange:e=>g(e.target.value)}):(0,s.jsx)("p",{children:null==a?void 0:a.email})]}),(0,s.jsxs)("div",{className:"info-row",children:[(0,s.jsx)("label",{children:"Phone"}),u?(0,s.jsx)("input",{type:"text",name:"Phone",value:N,onChange:e=>f(e.target.value)}):(0,s.jsx)("p",{children:null==a?void 0:a.phoneNo})]}),(0,s.jsxs)("div",{className:"info-row",children:[(0,s.jsx)("label",{children:"Address"}),u?(0,s.jsx)("input",{type:"text",name:b,value:b,onChange:e=>w(e.target.value)}):(0,s.jsx)("p",{children:null==a?void 0:a.address})]}),(0,s.jsxs)("button",{className:"edit-btn",onClick:()=>{u?I():(g((null==a?void 0:a.email)||""),f((null==a?void 0:a.phoneNo)||""),w((null==a?void 0:a.address)||""),x((null==a?void 0:a.image)||"")),p(!u)},children:[(0,s.jsx)(t.uO9,{})," ",u?"Save":"Edit"]})]}),(0,s.jsxs)("div",{className:"achievements",children:[(0,s.jsx)("h3",{className:"section-title",children:"Achievements in Last 6 Months"}),(0,s.jsxs)("ul",{className:"achievements-list",children:[S>0&&(0,s.jsxs)("li",{className:"achievement-item",children:["\uD83C\uDFA4 Received ",S," ",S>1?"Shoutouts":"Shoutout"]}),E>0&&(0,s.jsxs)("li",{className:"achievement-item",children:["\uD83C\uDF1F Won ",E," ",E>1?"Stars of the Month":"Star of the Month"," in ",P]})]})]})]})]})})]})}},5716:()=>{},346:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[915,773,178,479,446,711,204,829,173,565,790,441,517,358],()=>a(5602)),_N_E=e.O()}]);