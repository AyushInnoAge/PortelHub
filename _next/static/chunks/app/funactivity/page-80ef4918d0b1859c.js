(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[409],{9552:(e,t,a)=>{Promise.resolve().then(a.bind(a,8079))},8079:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var i=a(5155),r=a(2115);a(7216);var s=a(2110);a(5716);var n=a(2818);let l=async(e,t,a,i,r,s,l)=>{try{let o=new FormData;o.append("ActivityName",e),o.append("Description",t),o.append("Date",new Date(a).toISOString().split("T")[0]),o.append("Timing",i),o.append("Category",s),l&&l instanceof File?o.append("Image",l):console.warn("No valid image file provided."),r.forEach((e,t)=>{o.append("Organisers[".concat(t,"]"),e)});let c=await fetch("".concat(n.env.NEXT_PUBLIC_API_URL,"api/SocialActivity"),{method:"POST",body:o,headers:{}});if(!c.ok){let e=await c.text();throw Error("HTTP Error! Status: ".concat(c.status,", Message: ").concat(e))}return await c.json()}catch(e){throw console.error("Error adding social activity:",e.message),e}},o=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ALL",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{let i=await fetch("".concat(n.env.NEXT_PUBLIC_API_URL,"api/SocialActivity/activities/page/").concat(e,"?pageSize=").concat(a).concat("All"===t?"":"&category=".concat(t)),{method:"GET",headers:{"Content-Type":"application/json"}});if(!i.ok){let e=await i.text();throw Error("HTTP Error! Status: ".concat(i.status,", Message: ").concat(e))}return await i.json()}catch(e){throw console.error("Error fetching social activities:",e.message),e}};var c=a(3201);let d={All:"All","Team Lunch And Outings":1,Social:2,Festivals:3,Sports:4},g=["All","Team Lunch And Outings","Social","Festivals","Sports"],u=["All","TeamLunchAndOutings","Social","Festivals","Sports"];function m(){let[e,t]=(0,r.useState)("All"),[a,n]=(0,r.useState)(!1),[m,p]=(0,r.useState)([]),[v,h]=(0,r.useState)(!1),[y,x]=(0,r.useState)(""),{user:S,login:j}=(0,r.useContext)(c.c);(0,r.useEffect)(()=>{w()},[e]);let[f,N]=(0,r.useState)({activityName:"",description:"",date:"",timing:"",organisers:"",category:"",image:null}),w=async()=>{h(!0),x("");try{let e=await o(1,"All",30);p(e.data.data)}catch(e){x("Failed to fetch activities. Please try again."),console.error(e)}finally{h(!1)}},A="All"===e?m:m.filter(t=>String(t.category)==String(d[e])),C=async e=>{e.preventDefault(),h(!0),x("");try{let e={...f,date:new Date(f.date).toISOString(),organisers:f.organisers.split(",").map(e=>e.trim())},t=await l(e.activityName,e.description,e.date,e.timing,e.organisers,e.category,e.image);if(200==t.statusCode){s.oR.success("New Activity Added successfully!");let e=await o(1,"All",30);p(e.data.data),n(!1),N({activityName:"",description:"",date:"",timing:"",organisers:"",category:"",image:null})}}catch(e){x("Failed to add activity. Please try again."),console.error(e)}finally{h(!1)}};return(0,i.jsxs)("div",{className:"events-container",children:[(0,i.jsx)(s.N9,{position:"top-right",autoClose:3e3}),(0,i.jsxs)("div",{className:"header-container",children:[(0,i.jsx)("div",{style:{flex:1}}),(null==S?void 0:S.userRole)&&(1===S.userRole||2===S.userRole)&&(0,i.jsxs)("button",{className:"add-activity-btn",onClick:()=>n(!0),style:{marginLeft:"auto"},children:[(0,i.jsx)("span",{className:"plus-icon",children:"+ "}),"Add Activity"]})]}),a&&(0,i.jsx)("div",{className:"form-popup",children:(0,i.jsxs)("form",{onSubmit:C,className:"activity-form",children:[(0,i.jsx)("input",{type:"text",placeholder:"Activity Name",value:f.activityName,onChange:e=>N({...f,activityName:e.target.value}),required:!0}),(0,i.jsxs)("div",{className:"image-upload-container",children:[(0,i.jsx)("div",{id:"imagePreview",style:{maxWidth:"200px",maxHeight:"200px",marginBottom:"10px",display:"none"},children:(0,i.jsx)("img",{id:"preview",src:null,alt:"Preview",style:{width:"100%",height:"auto",objectFit:"contain"}})}),(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files[0];N({...f,image:t});let a=document.getElementById("preview"),i=document.getElementById("imagePreview");if(t){let e=new FileReader;e.onload=function(e){a.src=e.target.result,i.style.display="block"},e.readAsDataURL(t)}else i.style.display="none"},required:!0})]}),(0,i.jsx)("input",{type:"text",placeholder:"Description",value:f.description,onChange:e=>N({...f,description:e.target.value}),required:!0}),(0,i.jsx)("input",{type:"date",value:f.date,onChange:e=>N({...f,date:e.target.value}),required:!0}),(0,i.jsx)("input",{type:"time",value:f.timing,onChange:e=>N({...f,timing:e.target.value}),required:!0}),(0,i.jsx)("input",{type:"text",placeholder:"Organisers (comma separated)",value:f.organisers,onChange:e=>N({...f,organisers:e.target.value}),required:!0}),(0,i.jsxs)("select",{value:f.category,onChange:e=>N({...f,category:e.target.value}),required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select Category"}),u.slice(1).map((e,t)=>(0,i.jsx)("option",{value:t+1,children:e},e))]}),(0,i.jsx)("button",{type:"submit",disabled:v,children:v?"Adding...":"Add Event"}),(0,i.jsx)("button",{type:"button",onClick:()=>n(!1),children:"Cancel"}),y&&(0,i.jsx)("p",{className:"error",children:y})]})}),(0,i.jsxs)("div",{className:a?"blur-background":"",children:[(0,i.jsx)("div",{className:"categories",children:g.map(a=>(0,i.jsx)("button",{className:e===a?"active":"inactive",onClick:()=>t(a),children:a},a))}),(0,i.jsx)("div",{className:"events-grid",children:A.map((e,t)=>(0,i.jsxs)("div",{className:"event-card","data-date":new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"2-digit"}),children:[(0,i.jsx)("img",{src:e.image,alt:e.activityName}),(0,i.jsx)("h2",{children:e.activityName}),(0,i.jsx)("p",{children:e.description}),(0,i.jsxs)("div",{className:"event-timing",children:[(0,i.jsx)("span",{children:new Date(e.date).toDateString()}),(0,i.jsx)("span",{children:e.timing})]}),(0,i.jsxs)("p",{className:"organisers",children:[(0,i.jsx)("strong",{children:"Organiser:"})," ",e.organisers?e.organisers:"No Organiser"]})]},t))})]})]})}},3201:(e,t,a)=>{"use strict";a.d(t,{O:()=>l,c:()=>n});var i=a(5155),r=a(2115),s=a(6046);let n=(0,r.createContext)(),l=e=>{let{children:t}=e,[a,l]=(0,r.useState)(null),o=(0,s.useRouter)();return(0,r.useEffect)(()=>{let e=localStorage.getItem("token");if(!e){localStorage.removeItem("user"),o.push("/login");return}try{let t=JSON.parse(atob(e.split(".")[1])),a=1e3*t.exp;if(Date.now()>a){localStorage.removeItem("token"),localStorage.removeItem("user"),o.push("/login");return}}catch(e){console.log("Invalid Token"),localStorage.removeItem("token"),localStorage.removeItem("user"),o.push("/login")}},[o]),(0,r.useEffect)(()=>{let e=localStorage.getItem("user");e&&l(JSON.parse(e))},[]),(0,i.jsx)(n.Provider,{value:{user:a,login:e=>{l(e),localStorage.setItem("user",JSON.stringify(e))},logout:()=>{o.replace("/login"),localStorage.removeItem("token"),localStorage.removeItem("user"),l(null)}},children:t})}},5716:()=>{},7216:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[298,797,829,441,517,358],()=>t(9552)),_N_E=e.O()}]);